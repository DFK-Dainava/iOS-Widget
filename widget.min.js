// Variables used by Scriptable.
// These must be at the very top of the file. Do not edit.
// icon-color: red; icon-glyph: futbol;
async function getMatchesData(){try{let a=new Request("https://fantasy.dfkdainava.com/api/widget-matches");return await a.loadJSON()}catch(e){return console.log(e),{last_match:null,upcoming_match:null}}}async function createWidget(){let a=new ListWidget,e=await getMatchesData();if(a.backgroundColor=new Color("#A90000"),"small"===config.widgetFamily&&e.upcoming_match)return addSmallUpcomingMatch(a,e.upcoming_match),a;if(e.upcoming_match){let t=a.addText("Artėjančios rungtynės");t.centerAlignText(),t.font=Font.boldSystemFont(16),a.addSpacer(8),await addMatch(a.addStack(),e.upcoming_match)}else a.addText("Nėra informacijos apie artėjančias rungtynes").centerAlignText();if("large"===config.widgetFamily&&e.last_match){a.addSpacer(16);let d=a.addText("Praėjusios rungtynės");d.centerAlignText(),d.font=Font.boldSystemFont(16),a.addSpacer(8),await addMatch(a.addStack(),e.last_match)}return a}async function addMatch(a,e){let t=a.addStack();t.spacing=8,a.centerAlignContent(),await addTeamInfo(t.addStack(),e.home_team),e.score?addScore(t.addStack(),e.score):addDate(t.addStack(),new Date(1e3*e.timestamp),e.weekday,e.show_time),await addTeamInfo(t.addStack(),e.away_team)}async function addTeamInfo(a,e){a.layoutVertically(),a.centerAlignContent(),a.addSpacer();let t=a.addStack();t.addSpacer();t.addImage(await new Request(e.image).loadImage()).centerAlignImage(),t.addSpacer(),a.addSpacer(8);addCenteredText(a.addStack(),e.name).font=Font.regularSystemFont(10),a.addSpacer()}function addDate(a,e,t,d){a.layoutVertically(),a.centerAlignContent(),a.addSpacer();addCenteredText(a.addStack(),d?e.toLocaleTimeString().slice(0,5):"-").font=Font.semiboldSystemFont(24),a.addSpacer();addCenteredText(a.addStack(),e.toISOString().substr(5,5)).font=Font.semiboldSystemFont(24),a.addSpacer();addCenteredText(a.addStack(),t.charAt(0).toUpperCase()+t.slice(1)).font=Font.regularSystemFont(12),a.addSpacer()}function addScore(a,e){a.layoutVertically(),a.centerAlignContent(),a.addSpacer();addCenteredText(a.addStack(),e).font=Font.semiboldSystemFont(24),a.addSpacer()}function addCenteredText(a,e){a.addSpacer();let t=a.addText(e);return t.centerAlignText(),a.addSpacer(),t}function addSmallUpcomingMatch(a,e){let t=a.addStack();t.layoutVertically(),addCenteredText(t.addStack(),e.home_team.name),t.addSpacer();let d=t.addStack();d.layoutVertically();let n=new Date(1e3*e.timestamp),c=n.toISOString().substr(5,5);e.show_time&&(c+=" "+n.toLocaleTimeString().slice(0,5)),addCenteredText(d.addStack(),c),addCenteredText(d.addStack(),e.weekday.charAt(0).toUpperCase()+e.weekday.slice(1)),t.addSpacer(),addCenteredText(t.addStack(),e.away_team.name)}let widget=await createWidget();config.runsInWidget?Script.setWidget(widget):widget.presentLarge(),Script.complete();
